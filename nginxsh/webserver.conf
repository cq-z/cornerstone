server {
    listen       80;
    server_name www.test.cn;
    server_name test.cn;
    access_log  /data/logs/test/access.log main;
    error_log   /data/logs/test/error.log error;
	#若有url重写规则，可在这个位置添加，结构如下
	#rewrite **** ******
        #rewrite "^/((themes|public)/.*)$" "/$1"                   break;
        #rewrite "^/(app/.*/(doc|statics|lang|widgets)/.*)$" "/$1" break;
	#rewrite "^/(favicon.ico)$" "/$1"                          break;
        #rewrite "^/index.php(.*)$" "http://$host$1"               redirect;
        #rewrite "^/(.*)$" "/index.php/$1"                         last;



    location / {
        root 		/data/www/test/;
        index           index.htm index.html index.php;
    }
	#禁止执行PHP的目录。
    location ~ .*(attachments|forumdata|images|customavatars)/.*\.php$ {
        deny all;
    }

    location ~ \.php {
		root /data/www/test/;
                include                       fastcgi_params;
                fastcgi_pass                  127.0.0.1:9000;
                fastcgi_index                 index.php;

		set $real_script_name         $fastcgi_script_name;
		if ($fastcgi_script_name ~ "(.+?\.php)(/.+)") {
		    set $real_script_name     $1;
		    set $path_info            $2; 
		}
		#fastcgi_params
		fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;
		fastcgi_param  SERVER_SOFTWARE    nginx;
		fastcgi_param  QUERY_STRING       $query_string;
		fastcgi_param  REQUEST_METHOD     $request_method;
		fastcgi_param  CONTENT_TYPE       $content_type;
		fastcgi_param  CONTENT_LENGTH     $content_length;
		fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
		fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;
		fastcgi_param  REQUEST_URI        $request_uri;
		fastcgi_param  DOCUMENT_URI       $document_uri;
		fastcgi_param  DOCUMENT_ROOT      $document_root;
		fastcgi_param  SERVER_PROTOCOL    $server_protocol;
		fastcgi_param  REMOTE_ADDR        $remote_addr;
		fastcgi_param  REMOTE_PORT        $remote_port;
		fastcgi_param  SERVER_ADDR        $server_addr;
		fastcgi_param  SERVER_PORT        $server_port;
		fastcgi_param  SERVER_NAME        $server_name;
		fastcgi_param  REDIRECT_STATUS    200;
    }
    # 阻止用户代理，如扫描器，机器人和垃圾邮件msnbot和scrapbot机器人    
    #if ($http_user_agent ~* LWP::Simple|BBBike|wget|msnbot|scrapbot) {         
    #        return 403;     
    #}
    # 阻止被提名的垃圾邮件
    #if ( $http_referer ~* (babes|forsale|girl|jewelry|love|nudit|organic|poker|porn|sex|teen) ){        
    #   return 404;        
    #   return 403;
    #}
    #
}









